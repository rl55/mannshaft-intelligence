# SaaS BI Agent System Configuration

# Application Settings
app:
  name: "SaaS BI Agent"
  version: "1.0.0"
  debug: false
  environment: "production"  # development, staging, production

# API Settings
api:
  host: "0.0.0.0"
  port: 8000
  reload: false
  workers: 1
  cors_origins:
    - "*"

# Database Configuration
database:
  path: "data/agent_cache.db"
  schema_path: "data/schema.sql"
  pool_size: 5
  max_overflow: 10

# Google Gemini Configuration
gemini:
  api_key: "${GEMINI_API_KEY}"  # Load from environment variable
  # Model options for v1beta API (ADK uses v1beta):
  # Available models (as of Nov 2025):
  # - gemini-2.5-flash: Latest flash with implicit caching (may be overloaded)
  # - gemini-2.5-flash-lite: Lightweight 2.5 (may be overloaded)
  # - gemini-2.0-flash: Stable flash model (may be overloaded)
  # - gemini-2.0-flash-lite: Lightweight, stable, fast
  # - gemini-flash-latest: Alias for latest flash
  # NOTE: gemini-1.5-flash is NOT available in v1beta API!
  model: "gemini-2.0-flash-lite"  # Using lightweight model for stability and speed
  temperature: 0.7
  max_tokens: 2048
  timeout: 60  # Increased timeout for better reliability
  max_retries: 3  # ADK retry configuration: Reduced retries since model is more stable

# Evaluation Configuration
evaluation:
  quality_threshold: 0.75  # Quality score threshold for passing evaluation (0-1)
  max_regeneration_iterations: 3  # Maximum number of regeneration attempts

# Google Sheets Configuration (MCP Integration)
google_sheets:
  credentials_path: "${GOOGLE_CREDENTIALS_PATH}"  # Path to service account JSON
  scopes:
    - "https://www.googleapis.com/auth/spreadsheets.readonly"
    - "https://www.googleapis.com/auth/drive.readonly"
  max_retries: 3  # Maximum retry attempts
  retry_delay_seconds: 2  # Delay between retries
  rate_limit_delay_seconds: 1  # Delay for rate limiting
  cache_ttl_hours: 1  # Cache TTL for sheet data

# Sheet Configuration (Data Sources)
# Google Sheets structure:
# Revenue: "Weekly Revenue", "Customer Cohorts", "Revenue by Segment"
# Product: "Engagement Metrics", "Feature Adoption", "User Journey Metrics"
# Support: "Ticket Volume", "CSAT & Satisfaction", "Support Categories"
sheets:
  revenue:
    spreadsheet_id: "${REVENUE_SHEET_ID}"  # Example: "1abc..."
    # Note: Specifying just tab names reads ALL data from each tab (all rows and columns)
    # To limit to a specific range, use format: "Tab Name!A1:N100"
    ranges:
      - "Weekly Revenue"  # Reads all data from this tab
      - "Customer Cohorts"  # Reads all data from this tab
      - "Revenue by Segment"  # Reads all data from this tab
  
  product:
    spreadsheet_id: "${PRODUCT_SHEET_ID}"  # Example: "1def..."
    # Note: Specifying just tab names reads ALL data from each tab (all rows and columns)
    ranges:
      - "Engagement Metrics"  # Reads all data from this tab
      - "Feature Adoption"  # Reads all data from this tab
      - "User Journey Metrics"  # Reads all data from this tab
  
  support:
    spreadsheet_id: "${SUPPORT_SHEET_ID}"  # Example: "1ghi..."
    # Note: Specifying just tab names reads ALL data from each tab (all rows and columns)
    ranges:
      - "Ticket Volume"  # Reads all data from this tab
      - "CSAT & Satisfaction"  # Reads all data from this tab
      - "Support Categories"  # Reads all data from this tab

# Cache Configuration
cache:
  prompt_ttl_hours: 168  # 7 days
  agent_response_ttl_hours: 24  # 1 day
  enabled: true

# Agent Configuration
agents:
  timeout_seconds: 60
  max_retries: 3
  concurrent_execution: true
  default_confidence_threshold: 0.7

# Governance Settings
governance:
  guardrails_enabled: true
  hitl_enabled: true
  evaluation_enabled: true
  adaptive_rules_enabled: true

# Logging Configuration
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  format: "json"  # json or text
  file_path: "logs/app.log"
  max_bytes: 10485760  # 10MB
  backup_count: 5

# Monitoring & Observability
monitoring:
  metrics_enabled: true
  tracing_enabled: true
  error_tracking_enabled: true

# Synthesizer Configuration
synthesizer:
  enable_external_validation: true

# Google Search Configuration (Optional)
google_search:
  api_key: "${GOOGLE_SEARCH_API_KEY}"  # Optional: Google Custom Search API key
  cx: "${GOOGLE_SEARCH_CX}"  # Optional: Custom Search Engine ID

# Evaluation Configuration
evaluation:
  pass_threshold: 0.75  # Minimum score to pass evaluation
  regeneration_threshold: 0.75  # Score below which regeneration is triggered
  max_regenerations: 2  # Maximum regeneration attempts
  cache_ttl_hours: 168  # 7 days evaluation cache TTL

# HITL Configuration
hitl:
  auto_approval_delay_seconds: 2  # Delay for demo mode auto-approval
  notification_enabled: false  # Enable email/Slack notifications
  review_base_url: "https://app.example.com/review"  # Base URL for review interface
